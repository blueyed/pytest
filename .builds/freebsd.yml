image: freebsd/12.x

sources:
  - https://github.com/blueyed/pytest

environment:
  CI: "true"
  TOXENV: py37-xdist
  PYTEST_ADDOPTS: -ra -vv --durations=100
  # XXX: makes testing/test_pdb.py hang (with pexpect).
  PYTEST_REORDER_TESTS: 0
  PIP_DISABLE_PIP_VERSION_CHECK: 1

tasks:
  - install: |
      python3.7 -m venv .venv
      .venv/bin/python -m pip install --progress-bar=off git+https://github.com/blueyed/tox@master
      .venv/bin/tox --version
      cd pytest
      ../.venv/bin/tox --notest -v

  - test: |
      cd pytest
      env COLUMNS=120 ../.venv/bin/tox -v
